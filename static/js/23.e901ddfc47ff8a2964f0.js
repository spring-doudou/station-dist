webpackJsonp([23],{"3Whv":function(t,e,i){"use strict";function r(t){i("YS2M")}Object.defineProperty(e,"__esModule",{value:!0});var n=i("5a8G"),a=i("UsqI"),s=i("VU/8"),o=r,l=s(n.a,a.a,o,null,null);e.default=l.exports},"5a8G":function(t,e,i){"use strict";var r=i("OWV1"),n=i.n(r),a=i("n4NU");e.a={data:function(){var t=this;return{hezi_png:n.a,newStationName:"",center:[121.59996,31.197646],lng:121.59996,lat:31.197646,loaded:!1,tableHeight2:0,tableHeight:0,height:{width:"100%",height:""},height2:{width:"100%",height:"",overflow:"auto"},dialogVisible:!1,users:[],stations:[],zoom:12,markerStation:[],markerRefs:[],source:"click",plugin:[{pName:"ToolBar",events:{init:function(t){console.log(t)}}}],searchStation:"",currentRow:null,currentMarkIndex:0,orderDistance:{orderNumber:"",startTime:new Date,endTime:new Date,stationName:"",userName:"",distance:0,userId:0,stationId:0},markers:[],renderMarker:{position:[121.5273285,31.21715058],contentRender:function(e,i){return e("div",{style:{background:"#80cbc4",whiteSpace:"nowrap",border:"solid #ddd 1px",color:"#f00"},on:{click:function(){var e=t.renderMarker.position;t.renderMarker.position=[e[0]+.002,e[1]-.002]}}},["marker inner text"])}}}},created:function(){this.hh(),this.getStaions("")},methods:{hh:function(){this.height.height=window.innerHeight-85+"px",this.height2.height=window.innerHeight-85+"px",this.tableHeight=window.innerHeight-85,this.tableHeight2=window.innerHeight-153},setCurrent:function(t){this.$refs.singleTable.setCurrentRow(t)},handleCurrentChange:function(t){null!=t&&(this.users.forEach(function(t){t.isCurrent=0}),t.isCurrent=1,this.currentRow=t)},handler:function(t){alert(t+"-trigger")},handleAssign:function(t){var e=this;i.i(a.f)(t).then(function(t){var i=t.result;e.refreshMarkers(i)})},getStaions:function(t){var e=this;i.i(a.b)().then(function(t){var i=t.result;e.refreshMarkers(i)})},endTimeChange:function(){this.orderDistance.endTime=new Date(this.orderDistance.startTime.getTime()+1e3*this.orderDistance.distance/8)},refresh:function(){this.getUsers(""),this.getStaions("")},handleAddStation:function(){var t=this,e=this.markers.length,i={name:this.newStationName,position:[this.lng,this.lat],events:{click:function(t){},dragend:function(i){console.log("---event---: dragend"),t.markers[e].position=[i.lnglat.lng,i.lnglat.lat]}},visible:!0,draggable:!0,template:"<span>1</span>"};this.markers.push(i),this.saveStation(),this.dialogVisible=!1,this.newStationName=""},handleJumpToAccept:function(){this.$router.push({path:"waitToAccept"})},handleJumpToLoc:function(){this.$router.push({path:"waitToLoc"})},handleJumpToWork:function(){this.$router.push({path:"working"})},handleSaveOrder:function(){var t=this,e={orderNumber:this.orderDistance.orderNumber,stationId:this.orderDistance.stationId,userId:this.orderDistance.userId,areaId:this.$store.state.area.currentArea.id,startTime:this.orderDistance.startTime.getTime(),endTime:this.orderDistance.endTime.getTime()};i.i(a.g)(e).then(function(e){t.dialogVisible=!1,t.refresh()})},removeMarker:function(){this.markers.length&&(this.markers.remo,this.markers.splice(this.markers.length-1,1))},changeDraggle:function(){var t=this.markers[0].draggable;this.markers[0].draggable=!t},saveStation:function(){var t=this,e=[];this.markers.forEach(function(t){var i={id:t.id,name:t.name,latitude:t.position[1],longitude:t.position[0]};e.push(i)}),i.i(a.h)(e).then(function(e){var i=e.result;t.refreshMarkers(i)})},refreshMarkers:function(t){var e=this;this.markers=[];for(var i=0;i<t.length;i++)!function(i){var r=t[i];e.markers.push({position:[r.longitude,r.latitude],id:r.id,name:r.name,visible:!0,icon:e.hezi_png,events:{click:function(t){},dragend:function(t){e.markers[i].position=[t.lnglat.lng,t.lnglat.lat],e.saveStation()}},draggable:!0,template:"<span>1</span>"})}(i)}}}},OWV1:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAC/klEQVRYR8XXaajmYxgG8N9B8YmiBlkiZU+WRD7ZJUuTpMYWk8iWJZGyb2WXMnwbsiRT9pSlKEUIKVvKlgljxge+WIsu7nP6d/y31/vW3HU6b+d5nuu53vu57+u6z5z1HHM992+Kn2fErxOri8CGeB734MUpSRyFS3As/lyM1UXgUpyGE/E59scGeGskmf3wCz7GzngSj+OmMQT2xqtYjqfqwId4B2diW6zuILIl1uA+7I5Dat8yPICD8X7zbFsGzsdhOKE2XoeLsA++wht4Cfl7M87G4TgJW+MDrGjsewav4e4hAivxdePgE/gR5+KYqo09Kr1NrFz6LU7FowjOFji+Nt2KHYvgwrm2DHyJy7Gqdn2DK/EIzqufPTue4Nkim6c6C9djm8Yz3IbthjIwCYHj8HujU2ZCYJIneBe/4aB695k8wdgi/B73VzpTeKmLVP7URTimDb/DF9i+CHyE1MVM2jCYQ0J0A65GnmDjujwFOp+RqYQoBPqkOFUcYYq+pwg3qY6JOCULPy3qkP8lxcHoMpCoXL5thGVpXfZyidA1uLGlRSc2oy7JPxBv1uIu+Kw+RyXfK/fct/xjlG302XEbQBTu5NL6CxZteLhU8N6S7pkTOBovFGoX8b9qPSYU3R+MSTIQAzpiEPHfDc81PKD3yFgC55SdBmzeYpvAp5T2v4Jdy7KbbdlJYgyB9Pnb2As346oGWkwrLvcJYjQP1no64dOy8F/7UjCGwMXl4WuxpMAyK9yOzXFnkfij1jaqy3dCV1sucBoisBkis7HUM0r57kDEJaoXEnHPxXFZra3Dbsjv1hgikDnglpqCIrsX4mnchdcHCjJqGYPqbcs+AlshppOI5WbESrozIY2JIxtzwg41Zf3nXB+BfPNkYBbxGNIpowlkdovdJtrabhJSmbATbXOkrgw8hNMr5SmoaSLT87Vd4tRGIFNNKj+VG9Y/THN7dVDw0lEHlKYsQLYRiJrl/4IrSlymvP+f4/P1lOc4tAk41IazuLwXY70T+BukqsAhv5X5bgAAAABJRU5ErkJggg=="},UsqI:function(t,e,i){"use strict";var r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app-container"},[i("el-row",[i("el-button",{staticStyle:{width:"100px","vertical-align":"bottom"},attrs:{type:"primary",plain:""},on:{click:function(e){t.dialogVisible=!0}}},[t._v("新建电站\n    ")])],1),t._v(" "),i("el-row",{staticStyle:{height:"100%"},attrs:{gutter:20}},[i("el-col",{staticStyle:{height:"100%"},attrs:{span:16}},[i("div",{staticClass:"grid-content bg-purple",staticStyle:{width:"100%",height:"100%"}},[i("div",{staticClass:"amap-wrapper",style:t.height},[i("el-amap",{staticClass:"amap-demo",staticStyle:{width:"100%",height:"100%"},attrs:{plugin:t.plugin,vid:"amapDemo1",center:t.center,zoom:t.zoom,"resize-enable":!0}},t._l(t.markers,function(t,e){return i("el-amap-marker",{key:t.index,attrs:{position:t.position,events:t.events,visible:t.visible,draggable:t.draggable,icon:t.icon,vid:e}})}))],1)])]),t._v(" "),i("el-col",{staticStyle:{height:"100%"},attrs:{span:4}},[i("div",{staticStyle:{width:"100%",height:"100%"}},[i("el-table",{ref:"singleTable",attrs:{data:t.markers,"show-header":!1,border:!0,height:t.tableHeight2}},[i("el-table-column",{attrs:{align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-popover",{attrs:{trigger:"hover",placement:"top"}},[i("el-button",{attrs:{size:"mini"},on:{click:function(i){t.handleAssign(e.row.id)}}},[t._v("删除\n                ")]),t._v(" "),i("div",{attrs:{slot:"reference"},slot:"reference"},[i("div",{staticStyle:{font:"18px large"}},[t._v(t._s(e.row.name))])])],1)]}}])})],1)],1)])],1),t._v(" "),i("el-dialog",{attrs:{title:"新建电站",visible:t.dialogVisible,width:"30%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("el-input",{attrs:{placeholder:"请输入电站名称"},model:{value:t.newStationName,callback:function(e){t.newStationName=e},expression:"newStationName"}}),t._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.handleAddStation}},[t._v("确 定")])],1)],1)],1)},n=[],a={render:r,staticRenderFns:n};e.a=a},YS2M:function(t,e,i){var r=i("nXiT");"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);i("rjj0")("0e062975",r,!0)},n4NU:function(t,e,i){"use strict";function r(t,e){return i.i(c.a)({url:"/web_api/v1/users?areaId="+t+"&text="+e,method:"get"})}function n(){return i.i(c.a)({url:"/web_api/v1/stations",method:"get"})}function a(t,e,r,n){return i.i(c.a)({url:"/web_api/v1/order?areaId="+t+"&userId="+e+"&stationId="+r+"&status="+n,method:"get"})}function s(t,e){return i.i(c.a)({url:"/web_api/v1/order/distance?userId="+t+"&stationId="+e,method:"get"})}function o(t){return i.i(c.a)({url:"/web_api/v1/order",method:"post",data:{orderNumber:t.orderNumber,stationId:t.stationId,userId:t.userId,areaId:t.areaId,startTime:t.startTime,endTime:t.endTime}})}function l(t){return i.i(c.a)({url:"/web_api/v1/station",method:"post",data:t})}function d(t){return i.i(c.a)({url:"/web_api/v1/station?id="+t,method:"delete"})}function u(t){return i.i(c.a)({url:"/web_api/v1/order/markException",method:"put",data:{id:t.id,remark:t.remark}})}function h(t){return i.i(c.a)({url:"/web_api/v1/order",method:"put",data:{id:t.id,startTime:t.startTime,endTime:t.endTime,orderNumber:t.orderNumber}})}e.a=r,e.b=n,e.c=a,e.i=s,e.g=o,e.h=l,e.f=d,e.e=u,e.d=h;var c=i("Vo7i")},nXiT:function(t,e,i){e=t.exports=i("FZ+f")(!1),e.push([t.i,".amap-demo{height:100%}.amap-wrapper{width:100%;height:100%}",""])}});