webpackJsonp([37],{XIjo:function(e,t,r){"use strict";var i=r("n4NU");t.a={created:function(){this.getUsers(),this.getStations(),this.getOrders()},methods:{handleClick:function(e){console.log(e)},getUsers:function(){var e=this,t=this.$store.state.area.currentArea.id;r.i(i.a)(t,"").then(function(t){e.users=t.result})},getStations:function(){var e=this,t=this.$store.state.area.currentArea.id;r.i(i.b)(t,"").then(function(t){e.stations=t.result})},getOrders:function(){var e=this,t=this.$store.state.area.currentArea.id;r.i(i.c)(t,this.selectedUser,this.selectedStation,this.status).then(function(t){e.orders=t.result})},handleSelect:function(){this.getOrders()},handleClose:function(e){this.$confirm("确认关闭？").then(function(t){e()}).catch(function(e){})},handleSaveOrder:function(){var e=this,t={id:this.currentOrder.id,orderNumber:this.currentOrder.orderNumber,startTime:this.currentOrder.startTime.getTime(),endTime:this.currentOrder.endTime.getTime()};r.i(i.d)(t).then(function(t){e.editVisible=!1,e.refresh()})},viewOrder:function(e){this.currentOrder=e,this.currentOrder.startTime=new Date(e.startTime),this.currentOrder.endTime=new Date(e.endTime),this.viewVisible=!0},editOrder:function(e){this.currentOrder=e,this.currentOrder.startTime=new Date(e.startTime),this.currentOrder.endTime=new Date(e.endTime),this.editVisible=!0},exceptionOrder:function(e){this.currentOrder=e,this.exceptionVisible=!0},endTimeChange:function(){this.currentOrder.endTime=new Date(this.currentOrder.startTime.getTime()+1e3*this.currentOrder.distance)},refresh:function(){this.getOrders()},handleSaveException:function(){var e=this,t={id:this.currentOrder.id,remark:this.remark};r.i(i.e)(t).then(function(t){e.exceptionVisible=!1,e.refresh()})}},data:function(){return{viewVisible:!1,editVisible:!1,exceptionVisible:!1,currentOrder:{},selectedUser:"",selectedStation:"",orders:[],stations:[],users:[],remark:"",status:1}}}},lirD:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r("XIjo"),n=r("qA7m"),a=r("VU/8"),s=a(i.a,n.a,null,null,null);t.default=s.exports},n4NU:function(e,t,r){"use strict";function i(e,t){return r.i(m.a)({url:"/web_api/v1/users?areaId="+e+"&text="+t,method:"get"})}function n(){return r.i(m.a)({url:"/web_api/v1/stations",method:"get"})}function a(e,t,i,n){return r.i(m.a)({url:"/web_api/v1/order?areaId="+e+"&userId="+t+"&stationId="+i+"&status="+n,method:"get"})}function s(e,t){return r.i(m.a)({url:"/web_api/v1/order/distance?userId="+e+"&stationId="+t,method:"get"})}function l(e){return r.i(m.a)({url:"/web_api/v1/order",method:"post",data:{orderNumber:e.orderNumber,stationId:e.stationId,userId:e.userId,areaId:e.areaId,startTime:e.startTime,endTime:e.endTime}})}function o(e){return r.i(m.a)({url:"/web_api/v1/station",method:"post",data:e})}function d(e){return r.i(m.a)({url:"/web_api/v1/station?id="+e,method:"delete"})}function c(e){return r.i(m.a)({url:"/web_api/v1/order/markException",method:"put",data:{id:e.id,remark:e.remark}})}function u(e){return r.i(m.a)({url:"/web_api/v1/order",method:"put",data:{id:e.id,startTime:e.startTime,endTime:e.endTime,orderNumber:e.orderNumber}})}t.a=i,t.b=n,t.c=a,t.i=s,t.g=l,t.h=o,t.f=d,t.e=c,t.d=u;var m=r("Vo7i")},qA7m:function(e,t,r){"use strict";var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("el-row",[r("el-select",{attrs:{clearable:"",placeholder:"工作人员"},on:{change:e.handleSelect},model:{value:e.selectedUser,callback:function(t){e.selectedUser=t},expression:"selectedUser"}},e._l(e.users,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),e._v(" "),r("el-select",{attrs:{clearable:"",placeholder:"工作地点"},on:{change:e.handleSelect},model:{value:e.selectedStation,callback:function(t){e.selectedStation=t},expression:"selectedStation"}},e._l(e.stations,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.orders,border:""}},[r("el-table-column",{attrs:{prop:"orderNumber",label:"操作票编号",width:"120"}}),e._v(" "),r("el-table-column",{attrs:{prop:"stationName",label:"工作地点",width:"120"}}),e._v(" "),r("el-table-column",{attrs:{prop:"userName",label:"操作人员",width:"120"}}),e._v(" "),r("el-table-column",{attrs:{prop:"waitingFroTheTaskCtime",label:"指派时间",width:"180"}}),e._v(" "),r("el-table-column",{attrs:{prop:"startTimeDesc",label:"预定出发时间",width:"180"}}),e._v(" "),r("el-table-column",{attrs:{prop:"endTimeDesc",label:"预定到达时间",width:"180"}}),e._v(" "),r("el-table-column",{attrs:{fixed:"right",label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){e.viewOrder(t.row)}}},[e._v("查看")]),e._v(" "),r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){e.editOrder(t.row)}}},[e._v("编辑")]),e._v(" "),r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){e.exceptionOrder(t.row)}}},[e._v("标记异常")])]}}])})],1),e._v(" "),r("el-dialog",{attrs:{title:"任务详情",visible:e.viewVisible,width:"60%","before-close":e.handleClose},on:{"update:visible":function(t){e.viewVisible=t}}},[r("el-form",{ref:"currentOrder",attrs:{model:e.currentOrder,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"操作票编号"}},[r("el-input",{attrs:{readonly:!0},model:{value:e.currentOrder.orderNumber,callback:function(t){e.$set(e.currentOrder,"orderNumber",t)},expression:"currentOrder.orderNumber"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"工作地点"}},[r("el-input",{attrs:{readonly:!0},model:{value:e.currentOrder.stationName,callback:function(t){e.$set(e.currentOrder,"stationName",t)},expression:"currentOrder.stationName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"工作人员"}},[r("el-input",{attrs:{readonly:!0},model:{value:e.currentOrder.userName,callback:function(t){e.$set(e.currentOrder,"userName",t)},expression:"currentOrder.userName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"距离(km)"}},[r("el-input",{attrs:{readonly:!0},model:{value:e.currentOrder.distance/1e3,callback:function(t){e.$set(e.currentOrder,"distance/1000",t)},expression:"currentOrder.distance/1000"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"出发时间"}},[r("el-date-picker",{attrs:{readonly:!0,type:"datetime",placeholder:"选择日期时间",rules:[{required:!0,message:"出发时间不能为空"}]},on:{change:e.endTimeChange},model:{value:e.currentOrder.startTime,callback:function(t){e.$set(e.currentOrder,"startTime",t)},expression:"currentOrder.startTime"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"到达时间"}},[r("el-date-picker",{attrs:{readonly:!0,type:"datetime",placeholder:"选择日期时间"},model:{value:e.currentOrder.endTime,callback:function(t){e.$set(e.currentOrder,"endTime",t)},expression:"currentOrder.endTime"}})],1),e._v(" "),null!=e.currentOrder.records?r("el-steps",{attrs:{active:e.currentOrder.records.length}},e._l(e.currentOrder.records,function(e){return r("el-step",{key:e.id,attrs:{title:e.statusDesc,description:e.ctime}})})):e._e()],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.viewVisible=!1}}},[e._v("取 消")])],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"编辑订单",visible:e.editVisible,width:"60%","before-close":e.handleClose},on:{"update:visible":function(t){e.editVisible=t}}},[r("el-form",{ref:"currentOrder",attrs:{model:e.currentOrder,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"操作票编号"}},[r("el-input",{model:{value:e.currentOrder.orderNumber,callback:function(t){e.$set(e.currentOrder,"orderNumber",t)},expression:"currentOrder.orderNumber"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"工作地点"}},[r("el-input",{attrs:{readonly:!0},model:{value:e.currentOrder.stationName,callback:function(t){e.$set(e.currentOrder,"stationName",t)},expression:"currentOrder.stationName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"工作人员"}},[r("el-input",{attrs:{readonly:!0},model:{value:e.currentOrder.userName,callback:function(t){e.$set(e.currentOrder,"userName",t)},expression:"currentOrder.userName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"距离(km)"}},[r("el-input",{attrs:{readonly:!0},model:{value:e.currentOrder.distance/1e3,callback:function(t){e.$set(e.currentOrder,"distance/1000",t)},expression:"currentOrder.distance/1000"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"出发时间"}},[r("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间",rules:[{required:!0,message:"出发时间不能为空"}]},on:{change:e.endTimeChange},model:{value:e.currentOrder.startTime,callback:function(t){e.$set(e.currentOrder,"startTime",t)},expression:"currentOrder.startTime"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"到达时间"}},[r("el-date-picker",{attrs:{readonly:!0,type:"datetime",placeholder:"选择日期时间"},model:{value:e.currentOrder.endTime,callback:function(t){e.$set(e.currentOrder,"endTime",t)},expression:"currentOrder.endTime"}})],1)],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.editVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.handleSaveOrder}},[e._v("保存")])],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"标记异常",visible:e.exceptionVisible,width:"60%","before-close":e.handleClose},on:{"update:visible":function(t){e.exceptionVisible=t}}},[r("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"请输入内容"},model:{value:e.remark,callback:function(t){e.remark=t},expression:"remark"}}),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.exceptionVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.handleSaveException}},[e._v("保存")])],1)],1)],1)},n=[],a={render:i,staticRenderFns:n};t.a=a}});